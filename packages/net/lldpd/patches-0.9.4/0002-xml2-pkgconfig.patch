From d8a1e73d6e241f48a2a8fe6e4ec21471de2d0a47 Mon Sep 17 00:00:00 2001
From: Bert van Hall <bert.vanhall@avionic-design.de>
Date: Tue, 30 Aug 2016 10:41:35 +0200
Subject: [PATCH 2/2] xml2 pkgconfig

Use pkgconfig to check for libxml2.

Signed-off-by: Alban Bedel <alban.bedel@avionic-design.de>
Signed-off-by: Bert van Hall <bert.vanhall@avionic-design.de>
---
 configure.ac | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

diff --git a/configure.ac b/configure.ac
index 089ac8a..bfbf2ac 100644
--- a/configure.ac
+++ b/configure.ac
@@ -267,8 +267,14 @@ AC_ARG_WITH([xml],
     [--with-xml],
     [Enable XML output via libxml2 @<:@default=auto@:>@]),
   [],
-  [with_xml=auto])
-lldp_CHECK_XML2
+  [with_xml=no])
+if test x"$with_xml" = x"yes"; then
+  PKG_CHECK_MODULES([XML2], [libxml-2.0],
+    [AC_DEFINE_UNQUOTED([USE_XML], 1)],
+    [lldp_CHECK_XML2])
+else
+  lldp_CHECK_XML2
+fi
 
 # JSON
 AC_ARG_WITH([json],
-- 
2.1.0

