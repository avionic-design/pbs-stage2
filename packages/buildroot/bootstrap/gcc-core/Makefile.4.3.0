# build instructions for bootstrap GCC 4.3.0

ifneq ($(HOST), $(TARGET))
  conf-args += \
	--program-prefix=$(TARGET)- \
	--target=$(TARGET)

  CC = $(TARGET)-gcc
else
  CC = gcc
endif

ifneq ($(ROOTFS),)
  CC := $(ROOTFS)$(prefix)/bin/$(CC)
else
  CC := $(prefix)/bin/$(CC)
endif

conf-args += \
	--disable-libmudflap \
	--disable-libssp \
	--disable-shared \
	--disable-threads \
	--disable-nls \
	--enable-symvers=gnu \
	--enable-languages=c

ifeq ($(variant),sysroot)
  conf-args += \
	--with-local-prefix=$(ROOTFS) \
	--with-build-sysroot=$(ROOTFS) \
	--with-sysroot=$(ROOTFS) \
	--with-as=$(ROOTFS)$(prefix)/bin/$(TARGET)-as \
	--with-ld=$(ROOTFS)$(prefix)/bin/$(TARGET)-ld
else
  conf-args += \
	--includedir=$(ROOTFS)$(prefix)/$(TARGET)/include \
	--libexecdir=$(ROOTFS)$(prefix)/lib
endif

ifeq ($(FLOAT),soft)
  conf-args += --with-float=soft
endif

ifeq ($(MULTILIB),y)
  conf-args += --enable-multilib
else
  conf-args += --disable-multilib
endif

build-args += \
	all-gcc

install-targets += \
	install-gcc

package-post-install:
	ln -sf ../include-fixed/limits.h \
		`$(CC) --print-file-name=include`/limits.h

