# build instructions for final GCC 4.2.2

env = env -i PATH=$(ROOTFS)$(bootstrap-prefix)/bin:$(ROOTFS)$(prefix)/bin:${PATH}
BUILD := $(shell echo $(BUILD) | sed 's/unknown-//;s/pc-//')

#env += \
	$(call set-args, $(CROSS_TOOLS)) \
	$(call set-args, $(CROSS_FLAGS))

ifneq ($(HOST), $(TARGET))
  conf-args := \
	--target=$(TARGET) \
	--build=$(BUILD) \
	--host=$(HOST) \
	$(conf-args)
else
  conf-args := \
	--build=$(BUILD) \
	--host=$(HOST) \
	$(conf-args)
endif

conf-args += \
	--with-build-sysroot=$(ROOTFS) \
	--with-local-prefix=$(prefix) \
	--program-prefix=$(TARGET)-
#	--with-build-prefix=$(prefix)

ifeq ($(FLOAT),soft)
  conf-args += --with-float=soft
endif

ifeq ($(MULTILIB),y)
  conf-args += --enable-multilib
else
  conf-args += --disable-multilib
endif

conf-args += \
	--disable-nls \
	--enable-shared \
	--enable-languages=c,c++

package-post-install:
	ln -sf $(TARGET)-gcc $(ROOTFS)$(prefix)/bin/$(TARGET)-cc
#	$(dest-prefix)/bin/$(TARGET)-gcc -dumpspecs | \
		sed -r 's@/lib(64)?/ld@$(devel-prefix)/lib/ld@g' \
		> $(dir $(shell $(dest-prefix)/bin/$(TARGET)-gcc -print-libgcc-file-name))specs

