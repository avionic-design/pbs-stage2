diff --git a/Makefile.in b/Makefile.in
index 12a74f1..68d0939 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -57,11 +57,24 @@ libexec_PROGRAMS = extras/firmware/firmware$(EXEEXT) \
 	extras/fstab_import/fstab_import$(EXEEXT) \
 	extras/scsi_id/scsi_id$(EXEEXT) extras/usb_id/usb_id$(EXEEXT) \
 	extras/v4l_id/v4l_id$(EXEEXT) $(am__EXEEXT_1)
+@ENABLE_GLIB_TRUE@am__append_3 = extras/gudev/docs
+@ENABLE_GLIB_TRUE@am__append_4 = extras/gudev/libgudev-1.0.la
+@ENABLE_GLIB_TRUE@am__append_5 = extras/gudev/gudev-1.0.pc
+@ENABLE_GLIB_TRUE@am__append_6 = $(dist_extras_gudev_libgudev_1_0_la_SOURCES)
+@ENABLE_GLIB_TRUE@am__append_7 = \
+@ENABLE_GLIB_TRUE@	extras/gudev/COPYING \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevmarshal.list \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevenumtypes.h.template \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevenumtypes.c.template
+
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@am__append_8 = $(gir_DATA) $(typelibs_DATA)
+@ENABLE_GLIB_TRUE@am__append_9 = libgudev-install-move-hook
+@ENABLE_GLIB_TRUE@am__append_10 = libgudev-uninstall-move-hook
 
 # ------------------------------------------------------------------------------
 # conditional extras (need glib, libusb, libacl, ...)
 # ------------------------------------------------------------------------------
-@ENABLE_EXTRAS_TRUE@am__append_3 =  \
+@ENABLE_EXTRAS_TRUE@am__append_11 =  \
 @ENABLE_EXTRAS_TRUE@	rules/rules.d/75-net-description.rules \
 @ENABLE_EXTRAS_TRUE@	rules/rules.d/75-tty-description.rules \
 @ENABLE_EXTRAS_TRUE@	rules/rules.d/78-sound-card.rules \
@@ -71,31 +84,22 @@ libexec_PROGRAMS = extras/firmware/firmware$(EXEEXT) \
 @ENABLE_EXTRAS_TRUE@	extras/mtd_probe/75-probe_mtd.rules \
 @ENABLE_EXTRAS_TRUE@	extras/keymap/95-keymap.rules \
 @ENABLE_EXTRAS_TRUE@	extras/keymap/95-keyboard-force-release.rules
-@ENABLE_EXTRAS_TRUE@am__append_4 = extras/gudev/docs
-@ENABLE_EXTRAS_TRUE@am__append_5 = extras/gudev/libgudev-1.0.la
-@ENABLE_EXTRAS_TRUE@am__append_6 = extras/gudev/gudev-1.0.pc
-@ENABLE_EXTRAS_TRUE@am__append_7 = extras/gudev/COPYING \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevmarshal.list \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevenumtypes.h.template \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevenumtypes.c.template \
-@ENABLE_EXTRAS_TRUE@	extras/keymap/check-keymaps.sh
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@am__append_8 = $(gir_DATA) $(typelibs_DATA)
-@ENABLE_EXTRAS_TRUE@am__append_9 = libgudev-install-move-hook \
-@ENABLE_EXTRAS_TRUE@	udevacl-install-hook
-@ENABLE_EXTRAS_TRUE@am__append_10 = libgudev-uninstall-move-hook
-@ENABLE_EXTRAS_TRUE@am__append_11 = extras/hid2hci/hid2hci \
+@ENABLE_EXTRAS_TRUE@am__append_12 = extras/hid2hci/hid2hci \
 @ENABLE_EXTRAS_TRUE@	extras/udev-acl/udev-acl \
 @ENABLE_EXTRAS_TRUE@	extras/usb-db/usb-db extras/usb-db/pci-db \
 @ENABLE_EXTRAS_TRUE@	extras/mobile-action-modeswitch/mobile-action-modeswitch \
 @ENABLE_EXTRAS_TRUE@	extras/mtd_probe/mtd_probe \
 @ENABLE_EXTRAS_TRUE@	extras/keymap/keymap
-@ENABLE_EXTRAS_TRUE@am__append_12 = extras/keymap/findkeyboards \
+@ENABLE_EXTRAS_TRUE@am__append_13 = udevacl-install-hook
+@ENABLE_EXTRAS_TRUE@am__append_14 = $(nodist_extras_keymap_keymap_SOURCES)
+@ENABLE_EXTRAS_TRUE@am__append_15 = extras/keymap/check-keymaps.sh
+@ENABLE_EXTRAS_TRUE@am__append_16 = extras/keymap/findkeyboards \
 @ENABLE_EXTRAS_TRUE@	extras/keymap/keyboard-force-release.sh
-@ENABLE_EXTRAS_TRUE@am__append_13 = \
+@ENABLE_EXTRAS_TRUE@am__append_17 = \
 @ENABLE_EXTRAS_TRUE@	extras/keymap/keys.txt \
 @ENABLE_EXTRAS_TRUE@	extras/keymap/keys-from-name.gperf
 
-@ENABLE_EXTRAS_TRUE@am__append_14 = keymaps-distcheck-hook
+@ENABLE_EXTRAS_TRUE@am__append_18 = keymaps-distcheck-hook
 subdir = .
 DIST_COMMON = README $(am__configure_deps) $(am__dist_doc_DATA_DIST) \
 	$(am__dist_libexec_SCRIPTS_DIST) \
@@ -163,8 +167,8 @@ am__installdirs = "$(DESTDIR)$(libdir)" "$(DESTDIR)$(libexecdir)" \
 	"$(DESTDIR)$(includedir)" "$(DESTDIR)$(libgudev_includedir)"
 LTLIBRARIES = $(lib_LTLIBRARIES) $(noinst_LTLIBRARIES)
 am__DEPENDENCIES_1 =
-@ENABLE_EXTRAS_TRUE@extras_gudev_libgudev_1_0_la_DEPENDENCIES =  \
-@ENABLE_EXTRAS_TRUE@	libudev/libudev.la $(am__DEPENDENCIES_1)
+@ENABLE_GLIB_TRUE@extras_gudev_libgudev_1_0_la_DEPENDENCIES =  \
+@ENABLE_GLIB_TRUE@	libudev/libudev.la $(am__DEPENDENCIES_1)
 am__extras_gudev_libgudev_1_0_la_SOURCES_DIST =  \
 	extras/gudev/gudevenums.h extras/gudev/gudevenumtypes.h \
 	extras/gudev/gudevtypes.h extras/gudev/gudevclient.h \
@@ -172,14 +176,14 @@ am__extras_gudev_libgudev_1_0_la_SOURCES_DIST =  \
 	extras/gudev/gudevdevice.c extras/gudev/gudevenumerator.h \
 	extras/gudev/gudevenumerator.c extras/gudev/gudevprivate.h
 am__dirstamp = $(am__leading_dot)dirstamp
-@ENABLE_EXTRAS_TRUE@am_extras_gudev_libgudev_1_0_la_OBJECTS = extras/gudev/extras_gudev_libgudev_1_0_la-gudevclient.lo \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/extras_gudev_libgudev_1_0_la-gudevdevice.lo \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/extras_gudev_libgudev_1_0_la-gudevenumerator.lo
+@ENABLE_GLIB_TRUE@am_extras_gudev_libgudev_1_0_la_OBJECTS = extras/gudev/extras_gudev_libgudev_1_0_la-gudevclient.lo \
+@ENABLE_GLIB_TRUE@	extras/gudev/extras_gudev_libgudev_1_0_la-gudevdevice.lo \
+@ENABLE_GLIB_TRUE@	extras/gudev/extras_gudev_libgudev_1_0_la-gudevenumerator.lo
 am__dist_extras_gudev_libgudev_1_0_la_SOURCES_DIST =  \
 	extras/gudev/gudevmarshal.h extras/gudev/gudevmarshal.c \
 	extras/gudev/gudevenumtypes.h extras/gudev/gudevenumtypes.c
-@ENABLE_EXTRAS_TRUE@dist_extras_gudev_libgudev_1_0_la_OBJECTS = extras/gudev/extras_gudev_libgudev_1_0_la-gudevmarshal.lo \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/extras_gudev_libgudev_1_0_la-gudevenumtypes.lo
+@ENABLE_GLIB_TRUE@dist_extras_gudev_libgudev_1_0_la_OBJECTS = extras/gudev/extras_gudev_libgudev_1_0_la-gudevmarshal.lo \
+@ENABLE_GLIB_TRUE@	extras/gudev/extras_gudev_libgudev_1_0_la-gudevenumtypes.lo
 extras_gudev_libgudev_1_0_la_OBJECTS =  \
 	$(am_extras_gudev_libgudev_1_0_la_OBJECTS) \
 	$(dist_extras_gudev_libgudev_1_0_la_OBJECTS)
@@ -190,8 +194,8 @@ extras_gudev_libgudev_1_0_la_LINK = $(LIBTOOL) $(AM_V_lt) --tag=CC \
 	$(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=link $(CCLD) \
 	$(extras_gudev_libgudev_1_0_la_CFLAGS) $(CFLAGS) \
 	$(extras_gudev_libgudev_1_0_la_LDFLAGS) $(LDFLAGS) -o $@
-@ENABLE_EXTRAS_TRUE@am_extras_gudev_libgudev_1_0_la_rpath = -rpath \
-@ENABLE_EXTRAS_TRUE@	$(libdir)
+@ENABLE_GLIB_TRUE@am_extras_gudev_libgudev_1_0_la_rpath = -rpath \
+@ENABLE_GLIB_TRUE@	$(libdir)
 @WITH_SELINUX_TRUE@libudev_libudev_private_la_DEPENDENCIES =  \
 @WITH_SELINUX_TRUE@	$(am__DEPENDENCIES_1)
 am__libudev_libudev_private_la_SOURCES_DIST =  \
@@ -720,10 +724,10 @@ target_alias = @target_alias@
 top_build_prefix = @top_build_prefix@
 top_builddir = @top_builddir@
 top_srcdir = @top_srcdir@
-SUBDIRS = . libudev/docs $(am__append_4)
+SUBDIRS = . libudev/docs $(am__append_3)
 EXTRA_DIST = autogen.sh libudev/exported_symbols libudev/COPYING \
 	rules/arch rules/misc udev/udev.xml udev/udevadm.xml \
-	udev/udevd.xml $(am__append_7) $(TESTS) \
+	udev/udevd.xml $(am__append_7) $(am__append_15) $(TESTS) \
 	test/rule-syntax-check.py
 ACLOCAL_AMFLAGS = -I m4
 AM_MAKEFLAGS = --no-print-directory
@@ -740,12 +744,13 @@ DISTCHECK_CONFIGURE_FLAGS = \
 	--enable-gtk-doc \
 	--with-systemdsystemunitdir=$$dc_install_base/$(systemdsystemunitdir)
 
-CLEANFILES = $(am__append_8) $(am__append_13) udev-$(VERSION).tar.gz \
+CLEANFILES = $(am__append_8) $(am__append_17) udev-$(VERSION).tar.gz \
 	udev-$(VERSION).tar.bz2 $(BUILT_SOURCES)
-INSTALL_EXEC_HOOKS = libudev-install-move-hook $(am__append_9)
+INSTALL_EXEC_HOOKS = libudev-install-move-hook $(am__append_9) \
+	$(am__append_13)
 INSTALL_DATA_HOOKS = udev-confdirs $(am__append_2)
 UNINSTALL_EXEC_HOOKS = libudev-uninstall-move-hook $(am__append_10)
-DISTCHECK_HOOKS = $(am__append_14)
+DISTCHECK_HOOKS = $(am__append_18)
 
 # ------------------------------------------------------------------------------
 # libudev
@@ -754,7 +759,7 @@ LIBUDEV_CURRENT = 10
 LIBUDEV_REVISION = 0
 LIBUDEV_AGE = 10
 include_HEADERS = libudev/libudev.h
-lib_LTLIBRARIES = libudev/libudev.la $(am__append_5)
+lib_LTLIBRARIES = libudev/libudev.la $(am__append_4)
 libudev_libudev_la_SOURCES = \
 	libudev/libudev-private.h \
 	libudev/libudev.c \
@@ -778,7 +783,7 @@ libudev_libudev_private_la_SOURCES = $(libudev_libudev_la_SOURCES) \
 	libudev/libudev-queue-private.c $(am__append_1)
 @WITH_SELINUX_TRUE@libudev_libudev_private_la_LIBADD = $(SELINUX_LIBS)
 pkgconfigdir = $(libdir)/pkgconfig
-pkgconfig_DATA = libudev/libudev.pc $(am__append_6)
+pkgconfig_DATA = libudev/libudev.pc $(am__append_5)
 udevrulesdir = $(libexecdir)/rules.d
 
 # ------------------------------------------------------------------------------
@@ -800,7 +805,7 @@ dist_udevrules_DATA = rules/rules.d/50-udev-default.rules \
 	extras/floppy/60-floppy.rules \
 	extras/fstab_import/79-fstab_import.rules \
 	extras/v4l_id/60-persistent-v4l.rules \
-	extras/qemu/42-qemu-usb.rules $(am__append_3)
+	extras/qemu/42-qemu-usb.rules $(am__append_11)
 udevconfdir = $(sysconfdir)/udev
 dist_udevconf_DATA = udev.conf
 sharepkgconfigdir = $(datadir)/pkgconfig
@@ -863,7 +868,7 @@ udev_test_udev_LDADD = libudev/libudev-private.la
 # rule_generator - persistent network and optical device rule generator
 # ------------------------------------------------------------------------------
 dist_libexec_SCRIPTS = extras/rule_generator/write_cd_rules \
-	extras/rule_generator/write_net_rules $(am__append_12)
+	extras/rule_generator/write_net_rules $(am__append_16)
 udevhomedir = $(libexecdir)
 dist_udevhome_DATA = extras/rule_generator/rule_generator.functions
 
@@ -944,65 +949,64 @@ extras_usb_id_usb_id_LDADD = libudev/libudev-private.la
 # ------------------------------------------------------------------------------
 extras_v4l_id_v4l_id_SOURCES = extras/v4l_id/v4l_id.c
 extras_v4l_id_v4l_id_LDADD = libudev/libudev-private.la
+BUILT_SOURCES = $(am__append_6) $(am__append_14)
 
 # ------------------------------------------------------------------------------
 # GUdev - libudev gobject interface
 # ------------------------------------------------------------------------------
-@ENABLE_EXTRAS_TRUE@LIBGUDEV_CURRENT = 1
-@ENABLE_EXTRAS_TRUE@LIBGUDEV_REVISION = 0
-@ENABLE_EXTRAS_TRUE@LIBGUDEV_AGE = 1
-@ENABLE_EXTRAS_TRUE@libgudev_includedir = $(includedir)/gudev-1.0/gudev
-@ENABLE_EXTRAS_TRUE@libgudev_include_HEADERS = \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudev.h \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevenums.h \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevenumtypes.h \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevtypes.h \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevclient.h \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevdevice.h \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevenumerator.h
-
-@ENABLE_EXTRAS_TRUE@extras_gudev_libgudev_1_0_la_SOURCES = \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevenums.h \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevenumtypes.h \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevenumtypes.h\
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevtypes.h \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevclient.h \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevclient.c \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevdevice.h \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevdevice.c \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevenumerator.h \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevenumerator.c \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevprivate.h
-
-@ENABLE_EXTRAS_TRUE@dist_extras_gudev_libgudev_1_0_la_SOURCES = \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevmarshal.h \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevmarshal.c \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevenumtypes.h \
-@ENABLE_EXTRAS_TRUE@	extras/gudev/gudevenumtypes.c
-
-@ENABLE_EXTRAS_TRUE@BUILT_SOURCES = $(dist_extras_gudev_libgudev_1_0_la_SOURCES) \
-@ENABLE_EXTRAS_TRUE@	$(nodist_extras_keymap_keymap_SOURCES)
-@ENABLE_EXTRAS_TRUE@extras_gudev_libgudev_1_0_la_CPPFLAGS = \
-@ENABLE_EXTRAS_TRUE@	$(AM_CPPFLAGS) \
-@ENABLE_EXTRAS_TRUE@	-I$(top_builddir)/extras \
-@ENABLE_EXTRAS_TRUE@	-I$(top_srcdir)/extras \
-@ENABLE_EXTRAS_TRUE@	-I$(top_builddir)/extras/gudev \
-@ENABLE_EXTRAS_TRUE@	-I$(top_srcdir)/extras/gudev \
-@ENABLE_EXTRAS_TRUE@	-D_POSIX_PTHREAD_SEMANTICS -D_REENTRANT \
-@ENABLE_EXTRAS_TRUE@	-D_GUDEV_COMPILATION \
-@ENABLE_EXTRAS_TRUE@	-DG_LOG_DOMAIN=\"GUdev\"
-
-@ENABLE_EXTRAS_TRUE@extras_gudev_libgudev_1_0_la_CFLAGS = $(GLIB_CFLAGS)
-@ENABLE_EXTRAS_TRUE@extras_gudev_libgudev_1_0_la_LIBADD = libudev/libudev.la $(GLIB_LIBS)
-@ENABLE_EXTRAS_TRUE@extras_gudev_libgudev_1_0_la_LDFLAGS = \
-@ENABLE_EXTRAS_TRUE@	-version-info $(LIBGUDEV_CURRENT):$(LIBGUDEV_REVISION):$(LIBGUDEV_AGE) \
-@ENABLE_EXTRAS_TRUE@	-export-dynamic -no-undefined \
-@ENABLE_EXTRAS_TRUE@	-export-symbols-regex '^g_udev_.*'
-
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@girdir = $(GIRDIR)
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@gir_DATA = extras/gudev/GUdev-1.0.gir
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@typelibsdir = $(GIRTYPELIBDIR)
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@typelibs_DATA = extras/gudev/GUdev-1.0.typelib
+@ENABLE_GLIB_TRUE@LIBGUDEV_CURRENT = 1
+@ENABLE_GLIB_TRUE@LIBGUDEV_REVISION = 0
+@ENABLE_GLIB_TRUE@LIBGUDEV_AGE = 1
+@ENABLE_GLIB_TRUE@libgudev_includedir = $(includedir)/gudev-1.0/gudev
+@ENABLE_GLIB_TRUE@libgudev_include_HEADERS = \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudev.h \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevenums.h \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevenumtypes.h \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevtypes.h \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevclient.h \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevdevice.h \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevenumerator.h
+
+@ENABLE_GLIB_TRUE@extras_gudev_libgudev_1_0_la_SOURCES = \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevenums.h \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevenumtypes.h \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevenumtypes.h\
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevtypes.h \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevclient.h \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevclient.c \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevdevice.h \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevdevice.c \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevenumerator.h \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevenumerator.c \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevprivate.h
+
+@ENABLE_GLIB_TRUE@dist_extras_gudev_libgudev_1_0_la_SOURCES = \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevmarshal.h \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevmarshal.c \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevenumtypes.h \
+@ENABLE_GLIB_TRUE@	extras/gudev/gudevenumtypes.c
+
+@ENABLE_GLIB_TRUE@extras_gudev_libgudev_1_0_la_CPPFLAGS = \
+@ENABLE_GLIB_TRUE@	$(AM_CPPFLAGS) \
+@ENABLE_GLIB_TRUE@	-I$(top_builddir)/extras \
+@ENABLE_GLIB_TRUE@	-I$(top_srcdir)/extras \
+@ENABLE_GLIB_TRUE@	-I$(top_builddir)/extras/gudev \
+@ENABLE_GLIB_TRUE@	-I$(top_srcdir)/extras/gudev \
+@ENABLE_GLIB_TRUE@	-D_POSIX_PTHREAD_SEMANTICS -D_REENTRANT \
+@ENABLE_GLIB_TRUE@	-D_GUDEV_COMPILATION \
+@ENABLE_GLIB_TRUE@	-DG_LOG_DOMAIN=\"GUdev\"
+
+@ENABLE_GLIB_TRUE@extras_gudev_libgudev_1_0_la_CFLAGS = $(GLIB_CFLAGS)
+@ENABLE_GLIB_TRUE@extras_gudev_libgudev_1_0_la_LIBADD = libudev/libudev.la $(GLIB_LIBS)
+@ENABLE_GLIB_TRUE@extras_gudev_libgudev_1_0_la_LDFLAGS = \
+@ENABLE_GLIB_TRUE@	-version-info $(LIBGUDEV_CURRENT):$(LIBGUDEV_REVISION):$(LIBGUDEV_AGE) \
+@ENABLE_GLIB_TRUE@	-export-dynamic -no-undefined \
+@ENABLE_GLIB_TRUE@	-export-symbols-regex '^g_udev_.*'
+
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@girdir = $(GIRDIR)
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@gir_DATA = extras/gudev/GUdev-1.0.gir
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@typelibsdir = $(GIRTYPELIBDIR)
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@typelibs_DATA = extras/gudev/GUdev-1.0.typelib
 
 # ------------------------------------------------------------------------------
 # Bluetooth HID devices with special magic to switch the device
@@ -3120,63 +3124,63 @@ udev/%.7 udev/%.8 : udev/%.xml
 udev/%.html : udev/%.xml
 	$(AM_V_GEN)$(XSLTPROC) -o $@ -nonet http://docbook.sourceforge.net/release/xsl/current/xhtml-1_1/docbook.xsl $<
 
-@ENABLE_EXTRAS_TRUE@extras/gudev/gudevmarshal.h: extras/gudev/gudevmarshal.list
-@ENABLE_EXTRAS_TRUE@	$(AM_V_GEN)glib-genmarshal $< --prefix=g_udev_marshal --header > $@
-
-@ENABLE_EXTRAS_TRUE@extras/gudev/gudevmarshal.c: extras/gudev/gudevmarshal.list
-@ENABLE_EXTRAS_TRUE@	$(AM_V_GEN)echo "#include \"gudevmarshal.h\"" > $@ && \
-@ENABLE_EXTRAS_TRUE@	glib-genmarshal $< --prefix=g_udev_marshal --body >> $@
-
-@ENABLE_EXTRAS_TRUE@extras/gudev/gudevenumtypes.h: extras/gudev/gudevenumtypes.h.template extras/gudev/gudevenums.h
-@ENABLE_EXTRAS_TRUE@	$(AM_V_GEN)glib-mkenums --template $^ > \
-@ENABLE_EXTRAS_TRUE@	    $@.tmp && mv $@.tmp $@
-
-@ENABLE_EXTRAS_TRUE@extras/gudev/gudevenumtypes.c: extras/gudev/gudevenumtypes.c.template extras/gudev/gudevenums.h
-@ENABLE_EXTRAS_TRUE@	$(AM_V_GEN)glib-mkenums --template $^ > \
-@ENABLE_EXTRAS_TRUE@	    $@.tmp && mv $@.tmp $@
-
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@extras/gudev/GUdev-1.0.gir: extras/gudev/libgudev-1.0.la $(G_IR_SCANNER) Makefile.am
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@	$(AM_V_GEN)PKG_CONFIG_PATH=$(top_builddir)/data:$$PKG_CONFIG_PATH \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@	LD_LIBRARY_PATH=$(top_builddir)/extras/gudev:$$LD_LIBRARY_PATH \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@	$(G_IR_SCANNER) -v \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		--namespace GUdev \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		--nsversion=1.0 \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		--include=GObject-2.0 \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		--library=gudev-1.0 \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		--library-path=extras/gudev \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		--output $@ \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		--pkg=glib-2.0 \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		--pkg=gobject-2.0 \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		-I$(top_builddir)/extras \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		-I$(top_srcdir)/extras \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		-D_GUDEV_COMPILATION \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		-D_GUDEV_WORK_AROUND_DEV_T_BUG \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudev.h \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudevtypes.h \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudevenums.h \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(or $(wildcard $(top_builddir)/extras/gudev/gudevenumtypes.h),$(top_srcdir)/extras/gudev/gudevenumtypes.h) \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudevclient.h \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudevdevice.h \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudevenumerator.h \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudevclient.c \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudevdevice.c \
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudevenumerator.c
-
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@extras/gudev/GUdev-1.0.typelib: extras/gudev/GUdev-1.0.gir $(G_IR_COMPILER)
-@ENABLE_EXTRAS_TRUE@@ENABLE_INTROSPECTION_TRUE@	$(AM_V_GEN)g-ir-compiler $< -o $@
+@ENABLE_GLIB_TRUE@extras/gudev/gudevmarshal.h: extras/gudev/gudevmarshal.list
+@ENABLE_GLIB_TRUE@	$(AM_V_GEN)glib-genmarshal $< --prefix=g_udev_marshal --header > $@
+
+@ENABLE_GLIB_TRUE@extras/gudev/gudevmarshal.c: extras/gudev/gudevmarshal.list
+@ENABLE_GLIB_TRUE@	$(AM_V_GEN)echo "#include \"gudevmarshal.h\"" > $@ && \
+@ENABLE_GLIB_TRUE@	glib-genmarshal $< --prefix=g_udev_marshal --body >> $@
+
+@ENABLE_GLIB_TRUE@extras/gudev/gudevenumtypes.h: extras/gudev/gudevenumtypes.h.template extras/gudev/gudevenums.h
+@ENABLE_GLIB_TRUE@	$(AM_V_GEN)glib-mkenums --template $^ > \
+@ENABLE_GLIB_TRUE@	    $@.tmp && mv $@.tmp $@
+
+@ENABLE_GLIB_TRUE@extras/gudev/gudevenumtypes.c: extras/gudev/gudevenumtypes.c.template extras/gudev/gudevenums.h
+@ENABLE_GLIB_TRUE@	$(AM_V_GEN)glib-mkenums --template $^ > \
+@ENABLE_GLIB_TRUE@	    $@.tmp && mv $@.tmp $@
+
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@extras/gudev/GUdev-1.0.gir: extras/gudev/libgudev-1.0.la $(G_IR_SCANNER) Makefile.am
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@	$(AM_V_GEN)PKG_CONFIG_PATH=$(top_builddir)/data:$$PKG_CONFIG_PATH \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@	LD_LIBRARY_PATH=$(top_builddir)/extras/gudev:$$LD_LIBRARY_PATH \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@	$(G_IR_SCANNER) -v \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		--namespace GUdev \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		--nsversion=1.0 \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		--include=GObject-2.0 \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		--library=gudev-1.0 \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		--library-path=extras/gudev \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		--output $@ \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		--pkg=glib-2.0 \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		--pkg=gobject-2.0 \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		-I$(top_builddir)/extras \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		-I$(top_srcdir)/extras \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		-D_GUDEV_COMPILATION \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		-D_GUDEV_WORK_AROUND_DEV_T_BUG \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudev.h \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudevtypes.h \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudevenums.h \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(or $(wildcard $(top_builddir)/extras/gudev/gudevenumtypes.h),$(top_srcdir)/extras/gudev/gudevenumtypes.h) \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudevclient.h \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudevdevice.h \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudevenumerator.h \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudevclient.c \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudevdevice.c \
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@		$(top_srcdir)/extras/gudev/gudevenumerator.c
+
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@extras/gudev/GUdev-1.0.typelib: extras/gudev/GUdev-1.0.gir $(G_IR_COMPILER)
+@ENABLE_GLIB_TRUE@@ENABLE_INTROSPECTION_TRUE@	$(AM_V_GEN)g-ir-compiler $< -o $@
 
 # move lib from $(libdir) to $(rootlib_execdir) and update devel link, if needed
-@ENABLE_EXTRAS_TRUE@libgudev-install-move-hook:
-@ENABLE_EXTRAS_TRUE@	if test "$(libdir)" != "$(rootlib_execdir)"; then \
-@ENABLE_EXTRAS_TRUE@		mkdir -p $(DESTDIR)$(rootlib_execdir) && \
-@ENABLE_EXTRAS_TRUE@		so_img_name=$$(readlink $(DESTDIR)$(libdir)/libgudev-1.0.so) && \
-@ENABLE_EXTRAS_TRUE@		so_img_rel_target_prefix=$$(echo $(libdir) | sed 's,\(^/\|\)[^/][^/]*,..,g') && \
-@ENABLE_EXTRAS_TRUE@		ln -sf $$so_img_rel_target_prefix$(rootlib_execdir)/$$so_img_name $(DESTDIR)$(libdir)/libgudev-1.0.so && \
-@ENABLE_EXTRAS_TRUE@		mv $(DESTDIR)$(libdir)/libgudev-1.0.so.* $(DESTDIR)$(rootlib_execdir); \
-@ENABLE_EXTRAS_TRUE@	fi
-
-@ENABLE_EXTRAS_TRUE@libgudev-uninstall-move-hook:
-@ENABLE_EXTRAS_TRUE@	rm -f $(DESTDIR)$(rootlib_execdir)/libgudev-1.0.so*
+@ENABLE_GLIB_TRUE@libgudev-install-move-hook:
+@ENABLE_GLIB_TRUE@	if test "$(libdir)" != "$(rootlib_execdir)"; then \
+@ENABLE_GLIB_TRUE@		mkdir -p $(DESTDIR)$(rootlib_execdir) && \
+@ENABLE_GLIB_TRUE@		so_img_name=$$(readlink $(DESTDIR)$(libdir)/libgudev-1.0.so) && \
+@ENABLE_GLIB_TRUE@		so_img_rel_target_prefix=$$(echo $(libdir) | sed 's,\(^/\|\)[^/][^/]*,..,g') && \
+@ENABLE_GLIB_TRUE@		ln -sf $$so_img_rel_target_prefix$(rootlib_execdir)/$$so_img_name $(DESTDIR)$(libdir)/libgudev-1.0.so && \
+@ENABLE_GLIB_TRUE@		mv $(DESTDIR)$(libdir)/libgudev-1.0.so.* $(DESTDIR)$(rootlib_execdir); \
+@ENABLE_GLIB_TRUE@	fi
+
+@ENABLE_GLIB_TRUE@libgudev-uninstall-move-hook:
+@ENABLE_GLIB_TRUE@	rm -f $(DESTDIR)$(rootlib_execdir)/libgudev-1.0.so*
 
 @ENABLE_EXTRAS_TRUE@udevacl-install-hook:
 @ENABLE_EXTRAS_TRUE@	mkdir -p $(DESTDIR)$(prefix)/lib/ConsoleKit/run-seat.d
diff --git a/configure b/configure
index 67f3cde..dfd52e5 100755
--- a/configure
+++ b/configure
@@ -773,9 +773,11 @@ USBUTILS_LIBS
 USBUTILS_CFLAGS
 LIBUSB_LIBS
 LIBUSB_CFLAGS
+GPERF
+ENABLE_GLIB_FALSE
+ENABLE_GLIB_TRUE
 GLIB_LIBS
 GLIB_CFLAGS
-GPERF
 WITH_SYSTEMD_FALSE
 WITH_SYSTEMD_TRUE
 systemdsystemunitdir
@@ -931,6 +933,7 @@ enable_debug
 enable_logging
 with_firmware_path
 with_systemdsystemunitdir
+enable_glib
 enable_extras
 with_pci_ids_path
 enable_introspection
@@ -1590,6 +1593,7 @@ Optional Features:
   --enable-gtk-doc-pdf    build documentation in pdf format [[default=no]]
   --enable-debug          enable debug messages
   --disable-logging       disable system logging
+  --disable-glib          disable GLIB dependencies
   --disable-extras        disable extras with external dependencies
   --disable-introspection disable GObject introspection
 
@@ -5158,13 +5162,13 @@ if ${lt_cv_nm_interface+:} false; then :
 else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
-  (eval echo "\"\$as_me:5161: $ac_compile\"" >&5)
+  (eval echo "\"\$as_me:5165: $ac_compile\"" >&5)
   (eval "$ac_compile" 2>conftest.err)
   cat conftest.err >&5
-  (eval echo "\"\$as_me:5164: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
+  (eval echo "\"\$as_me:5168: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
   (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
   cat conftest.err >&5
-  (eval echo "\"\$as_me:5167: output\"" >&5)
+  (eval echo "\"\$as_me:5171: output\"" >&5)
   cat conftest.out >&5
   if $GREP 'External.*some_variable' conftest.out > /dev/null; then
     lt_cv_nm_interface="MS dumpbin"
@@ -6369,7 +6373,7 @@ ia64-*-hpux*)
   ;;
 *-*-irix6*)
   # Find out which ABI we are using.
-  echo '#line 6372 "configure"' > conftest.$ac_ext
+  echo '#line 6376 "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
@@ -7601,11 +7605,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:7604: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:7608: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:7608: \$? = $ac_status" >&5
+   echo "$as_me:7612: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -7940,11 +7944,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:7943: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:7947: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:7947: \$? = $ac_status" >&5
+   echo "$as_me:7951: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -8045,11 +8049,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:8048: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:8052: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:8052: \$? = $ac_status" >&5
+   echo "$as_me:8056: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -8100,11 +8104,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:8103: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:8107: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:8107: \$? = $ac_status" >&5
+   echo "$as_me:8111: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -10467,7 +10471,7 @@ else
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<_LT_EOF
-#line 10470 "configure"
+#line 10474 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -10563,7 +10567,7 @@ else
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<_LT_EOF
-#line 10566 "configure"
+#line 10570 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -11432,58 +11436,14 @@ else
 fi
 
 
-# Check whether --enable-extras was given.
-if test "${enable_extras+set}" = set; then :
-  enableval=$enable_extras;
+# Check whether --enable-glib was given.
+if test "${enable_glib+set}" = set; then :
+  enableval=$enable_glib;
 else
-  enable_extras=yes
+  enable_glib=yes
 fi
 
-if test "x$enable_extras" = xyes; then
-	# Extract the first word of "gperf", so it can be a program name with args.
-set dummy gperf; ac_word=$2
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
-$as_echo_n "checking for $ac_word... " >&6; }
-if ${ac_cv_path_GPERF+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  case $GPERF in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_GPERF="$GPERF" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-    for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_path_GPERF="$as_dir/$ac_word$ac_exec_ext"
-    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-  done
-IFS=$as_save_IFS
-
-  ;;
-esac
-fi
-GPERF=$ac_cv_path_GPERF
-if test -n "$GPERF"; then
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $GPERF" >&5
-$as_echo "$GPERF" >&6; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-fi
-
-
-	if test -z "$GPERF"; then
-		as_fn_error $? "gperf is needed" "$LINENO" 5
-	fi
-
+if test "x$enable_glib" = xyes; then
 
 pkg_failed=no
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking for GLIB" >&5
@@ -11575,6 +11535,67 @@ $as_echo "yes" >&6; }
 fi
 
 
+fi
+ if test "x$enable_glib" = xyes; then
+  ENABLE_GLIB_TRUE=
+  ENABLE_GLIB_FALSE='#'
+else
+  ENABLE_GLIB_TRUE='#'
+  ENABLE_GLIB_FALSE=
+fi
+
+
+# Check whether --enable-extras was given.
+if test "${enable_extras+set}" = set; then :
+  enableval=$enable_extras;
+else
+  enable_extras=yes
+fi
+
+if test "x$enable_extras" = xyes; then
+	# Extract the first word of "gperf", so it can be a program name with args.
+set dummy gperf; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_path_GPERF+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  case $GPERF in
+  [\\/]* | ?:[\\/]*)
+  ac_cv_path_GPERF="$GPERF" # Let the user override the test with a path.
+  ;;
+  *)
+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_path_GPERF="$as_dir/$ac_word$ac_exec_ext"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+  ;;
+esac
+fi
+GPERF=$ac_cv_path_GPERF
+if test -n "$GPERF"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $GPERF" >&5
+$as_echo "$GPERF" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+	if test -z "$GPERF"; then
+		as_fn_error $? "gperf is needed" "$LINENO" 5
+	fi
 
 	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for acl_init in -lacl" >&5
 $as_echo_n "checking for acl_init in -lacl... " >&6; }
@@ -12198,6 +12219,10 @@ if test -z "${WITH_SYSTEMD_TRUE}" && test -z "${WITH_SYSTEMD_FALSE}"; then
   as_fn_error $? "conditional \"WITH_SYSTEMD\" was never defined.
 Usually this means the macro was only invoked conditionally." "$LINENO" 5
 fi
+if test -z "${ENABLE_GLIB_TRUE}" && test -z "${ENABLE_GLIB_FALSE}"; then
+  as_fn_error $? "conditional \"ENABLE_GLIB\" was never defined.
+Usually this means the macro was only invoked conditionally." "$LINENO" 5
+fi
 if test -z "${ENABLE_EXTRAS_TRUE}" && test -z "${ENABLE_EXTRAS_FALSE}"; then
   as_fn_error $? "conditional \"ENABLE_EXTRAS\" was never defined.
 Usually this means the macro was only invoked conditionally." "$LINENO" 5
