#!/bin/sh

ETH_DEFAULT_DRIVER="ethoc"
ETH0_DEFAULT_ADDR="192.168.255.1"
ETH1_DEFAULT_ADDR="192.168.255.2"

if [ -f /etc/default/networking ]; then
	. /etc/default/networking
fi

# setup loopback interface
/sbin/ifconfig lo 127.0.0.1

# load the ethernet device driver
if [ "x$ETH_DRIVER" != "x" ]; then
	/sbin/modprobe "$ETH_DRIVER"
else
	/sbin/modprobe "$ETH_DEFAULT_DRIVER"
fi

echo -n 'Bringing up network interfaces: '

# configure primary ethernet interface
if [ "x$ETH0_UP" = "xy" ]; then
	if [ "x$ETH0_ADDR" = "x" ]; then
		ETH0_ADDR="$ETH0_DEFAULT_ADDR"
	fi

	if [ "x$ETH0_ADDR" != "x" ]; then
		echo -n ' eth0'
		if /sbin/ifconfig eth0 "$ETH0_ADDR" > /dev/null 2>&1; then
			echo -n '(OK)'
		else
			echo -n '(failed)'
		fi

		done=1
	fi
fi

# configure secondary ethernet interface
if [ "x$ETH1_UP" = "xy" ]; then
	if [ "x$ETH1_ADDR" = "x" ]; then
		ETH1_ADDR="$ETH1_DEFAULT_ADDR"
	fi

	if [ "x$ETH1_ADDR" != "x" ]; then
		echo -n ' eth1'
		if /sbin/ifconfig eth1 "$ETH1_ADDR" > /dev/null 2>&1; then
			echo -n '(OK)'
		else
			echo -n '(failed)'
		fi

		done=1
	fi
fi

if [ "x$done" = "x" ]; then
	echo ' done.'
fi

