diff --git a/debianutils/run_parts.c b/debianutils/run_parts.c
index ea019c2..3275aa3 100644
--- a/debianutils/run_parts.c
+++ b/debianutils/run_parts.c
@@ -33,12 +33,10 @@
 #include "libbb.h"
 
 struct globals {
-	char **names;
 	int    cur;
 	char  *cmd[1];
 };
 #define G (*(struct globals*)&bb_common_bufsiz1)
-#define names (G.names)
 #define cur   (G.cur  )
 #define cmd   (G.cmd  )
 
@@ -77,8 +75,10 @@ static int bb_alphasort(const void *p1, const void *p2)
 	return (option_mask32 & OPT_r) ? -r : r;
 }
 
-static int FAST_FUNC act(const char *file, struct stat *statbuf, void *args UNUSED_PARAM, int depth)
+static int FAST_FUNC act(const char *file, struct stat *statbuf, void *args, int depth)
 {
+	char ***names = args;
+
 	if (depth == 1)
 		return TRUE;
 
@@ -90,9 +90,9 @@ static int FAST_FUNC act(const char *file, struct stat *statbuf, void *args UNUS
 		return SKIP;
 	}
 
-	names = xrealloc_vector(names, 4, cur);
-	names[cur++] = xstrdup(file);
-	/*names[cur] = NULL; - xrealloc_vector did it */
+	*names = xrealloc_vector(*names, 4, cur);
+	(*names)[cur++] = xstrdup(file);
+	/*(*names)[cur] = NULL; - xrealloc_vector did it */
 
 	return TRUE;
 }
@@ -115,6 +115,7 @@ int run_parts_main(int argc UNUSED_PARAM, char **argv)
 {
 	const char *umask_p = "22";
 	llist_t *arg_list = NULL;
+	char **names = NULL;
 	unsigned n;
 	int ret;
 
@@ -140,7 +141,7 @@ int run_parts_main(int argc UNUSED_PARAM, char **argv)
 			ACTION_RECURSE|ACTION_FOLLOWLINKS,
 			act,            /* file action */
 			act,            /* dir action */
-			NULL,           /* user data */
+			&names,         /* user data */
 			1               /* depth */
 		);
 
