Allow specifying the getty to run for other distros.

From: Thierry Reding <thierry.reding@avionic-design.de>


---
 configure.ac            |    8 ++++++++
 units/getty@.service.m4 |    1 +
 2 files changed, 9 insertions(+), 0 deletions(-)

diff --git a/configure.ac b/configure.ac
index a39bad7..dae2a31 100644
--- a/configure.ac
+++ b/configure.ac
@@ -331,6 +331,9 @@ case $with_distro in
         other)
                 AS_IF([test "x$with_syslog_service" = "x"],
                         [AC_MSG_ERROR([With --distro=other, you must pass --with-syslog-service= to configure])])
+                AS_IF([test "x$with_getty" = "x"],
+                        [AC_MSG_ERROR([With --distro=other, you must pass --with-getty= to configure])])
+                M4_DISTRO_FLAG="-DTARGET_GETTY=\"$with_getty\""
                 ;;
         *)
                 AC_MSG_ERROR([Your distribution (${with_distro}) is not yet supported, SysV init scripts could not be found! (patches welcome); you can specify --with-distro=other to skip this check])
@@ -355,6 +358,11 @@ AC_ARG_WITH([syslog-service],
         [SPECIAL_SYSLOG_SERVICE="$withval"],
         [])
 
+AC_ARG_WITH([getty],
+        [AS_HELP_STRING([--with-getty=GETTY],
+                [Specify the getty command to run on tty devices @<:@default=based on distro@:>@])],
+        [], [])
+
 AC_SUBST(SYSTEM_SYSVINIT_PATH)
 AC_SUBST(SYSTEM_SYSVRCND_PATH)
 AC_SUBST(SPECIAL_SYSLOG_SERVICE)
diff --git a/units/getty@.service.m4 b/units/getty@.service.m4
index 8df77c7..c518af2 100644
--- a/units/getty@.service.m4
+++ b/units/getty@.service.m4
@@ -10,6 +10,7 @@ m4_ifdef(`TARGET_SUSE', `m4_define(`GETTY', `/sbin/mingetty')')m4_dnl
 m4_ifdef(`TARGET_DEBIAN', `m4_define(`GETTY', `/sbin/getty 38400')')m4_dnl
 m4_ifdef(`TARGET_GENTOO', `m4_define(`GETTY', `/sbin/agetty 38400')')m4_dnl
 m4_ifdef(`TARGET_ARCH', `m4_define(`GETTY', `/sbin/agetty -8 38400')')m4_dnl
+m4_ifdef(`TARGET_GETTY', `m4_define(`GETTY', `TARGET_GETTY')')m4_dnl
 m4_dnl
 [Unit]
 Description=Getty on %I
