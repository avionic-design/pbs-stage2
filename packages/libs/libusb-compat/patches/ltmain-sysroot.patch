--- a/ltmain.sh	2008-04-29 22:21:21.000000000 +0200
+++ b/ltmain.sh	2009-01-09 11:19:22.000000000 +0100
@@ -4337,6 +4337,13 @@
 	  prev=
 	  continue
 	  ;;
+	sysroot)
+	  sysroot="$arg"
+	  compiler_flags="$compiler_flags --sysroot $arg"
+	  compile_command="$compile_command --sysroot $arg"
+	  prev=
+	  continue
+	  ;;
 	precious_regex)
 	  precious_files_regex="$arg"
 	  prev=
@@ -4469,6 +4476,11 @@
 	continue
 	;;
 
+      --sysroot)
+        prev=sysroot
+        continue
+        ;;
+
       # The native IRIX linker understands -LANG:*, -LIST:* and -LNO:*
       # so, if we see these flags be careful not to treat them like -L
       -L[A-Z][A-Z]*:*)
@@ -5104,7 +5116,7 @@
 	  for searchdir in $searchdirs; do
 	    for search_ext in .la $std_shrext .so .a; do
 	      # Search the libtool library
-	      lib="$searchdir/lib${name}${search_ext}"
+	      lib="${sysroot}$searchdir/lib${name}${search_ext}"
 	      if test -f "$lib"; then
 		if test "$search_ext" = ".la"; then
 		  found=yes
@@ -8180,6 +8192,11 @@
 	  if test "$installed" = yes && test "$D"; then
 	    install_libdir=`echo "$install_libdir" |sed -e "s:$D:/:g" -e 's:/\+:/:g'`
 	  fi
+
+	  if test -n "$install_libdir"; then
+		  install_libdir="${sysroot}$install_libdir"
+	  fi
+
 	  $ECHO > $output "\
 # $outputname - a libtool library file
 # Generated by $PROGRAM (GNU $PACKAGE$TIMESTAMP) $VERSION
